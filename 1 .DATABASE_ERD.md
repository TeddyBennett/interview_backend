# Database ERD - Interview Backend

This document contains the Entity Relationship Diagram (ERD) for the database schema defined in `init.sql`.

## ER Diagram (Mermaid)

```mermaid
erDiagram
    Users ||--o{ Passengers : "creates"
    Administrators ||--o{ ApiKeys : "manages"
    Countries ||--o{ Documents : "issues"
    DocumentTypes ||--o{ Documents : "categorizes"
    Documents ||--o{ Passengers : "identifies"

    Users {
        string Id PK
        string Username UK
        string Password
        string FullName
        string ProfileImageUrl
        string Role
        timestamp CreatedAt
    }

    Administrators {
        int Id PK
        string Username UK
        string PasswordHash
        string Role
        timestamp CreatedAt
    }

    ApiKeys {
        int Id PK
        string ClientName
        string HashedKey UK
        boolean IsEnabled
        int CreatedById FK
        timestamp CreatedAt
        timestamp ExpiresAt
    }

    Countries {
        int Id PK
        string Code UK
        string Name
    }

    DocumentTypes {
        int Id PK
        string Name
    }

    Documents {
        string Id PK
        int DocumentTypeId FK
        string DocumentNumber
        int IssuedCountryId FK
        date IssueDate
        date ExpiryDate
        timestamp CreatedAt
    }

    Passengers {
        int PassengerId PK
        string DocId FK
        string FirstName
        string LastName
        date DateOfBirth
        string Gender
        string FaceImageUrl
        string CreatedByUserId FK
        timestamp CreatedAt
    }
```

## Entity Descriptions

### 1. Users
Stores the system users who are authorized to manage passenger data.
- **Id**: Unique identifier (using ULID/String format).
- **Role**: Determines permissions (Default: 'User').

### 2. Administrators
Internal administrative accounts for system-level management.
- **PasswordHash**: BCrypt hashed credentials.

### 3. ApiKeys
Keys used for external system integrations.
- **CreatedById**: Links to the administrator who generated the key.

### 4. Passengers & Documents
The core business logic.
- **Documents**: Contains sensitive identification data, isolated from the passenger's basic profile.
- **Passengers**: Linked to a document and a staff user who created the record.
